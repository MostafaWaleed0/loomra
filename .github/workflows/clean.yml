name: ğŸ§¹ Cleanup Old Artifacts

on:
  schedule:
    # Run daily at 1 AM UTC
    - cron: '0 1 * * *'
  workflow_dispatch:

jobs:
  cleanup:
    name: ğŸ—‘ï¸ Delete Old Build Artifacts
    runs-on: ubuntu-latest

    permissions:
      actions: write
      contents: read

    steps:
      - name: Delete artifacts older than 7 days
        uses: c-hive/gha-remove-artifacts@v1
        with:
          age: '7 days'
          skip-recent: 3
          skip-tags: true

      - name: Delete specific old artifacts
        uses: geekyeggo/delete-artifact@v5
        with:
          name: |
            windows-build
            windows-build-*
          useGlob: true
          failOnError: false

      - name: Print Summary
        run: |
          echo "âœ… Cleanup completed!"
          echo "ğŸ“Š Artifacts older than 7 days have been removed"
          echo "ğŸ”’ Last 3 artifacts preserved"
